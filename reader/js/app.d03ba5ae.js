(function(e){function t(t){for(var s,o,a=t[0],c=t[1],l=t[2],d=0,m=[];d<a.length;d++)o=a[d],Object.prototype.hasOwnProperty.call(r,o)&&r[o]&&m.push(r[o][0]),r[o]=0;for(s in c)Object.prototype.hasOwnProperty.call(c,s)&&(e[s]=c[s]);u&&u(t);while(m.length)m.shift()();return i.push.apply(i,l||[]),n()}function n(){for(var e,t=0;t<i.length;t++){for(var n=i[t],s=!0,a=1;a<n.length;a++){var c=n[a];0!==r[c]&&(s=!1)}s&&(i.splice(t--,1),e=o(o.s=n[0]))}return e}var s={},r={app:0},i=[];function o(t){if(s[t])return s[t].exports;var n=s[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=e,o.c=s,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)o.d(n,s,function(t){return e[t]}.bind(null,s));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="";var a=window["webpackJsonp"]=window["webpackJsonp"]||[],c=a.push.bind(a);a.push=t,a=a.slice();for(var l=0;l<a.length;l++)t(a[l]);var u=c;i.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"01aa":function(e,t,n){},"034f":function(e,t,n){"use strict";n("85ec")},"0420":function(e,t,n){},"0604":function(e,t,n){"use strict";n("aad5")},"07e9":function(e,t,n){},"089a":function(e,t,n){e.exports=n.p+"fonts/element-icons.535877f5.woff"},"0c82":function(e,t,n){},"0ca3":function(e,t,n){},"0d7e":function(e,t,n){},"0dcb":function(e,t,n){},"15f5":function(e,t,n){e.exports=n.p+"img/logined.687bce67.svg"},1771:function(e,t,n){var s={"./an-login.svg":"1dca","./element-ui/alert.css":"8068","./element-ui/aside.css":"25e6","./element-ui/autocomplete.css":"6dcb","./element-ui/avatar.css":"5467","./element-ui/backtop.css":"3cf0","./element-ui/badge.css":"62a1","./element-ui/base.css":"0420","./element-ui/breadcrumb-item.css":"832e","./element-ui/breadcrumb.css":"60c7","./element-ui/button-group.css":"5e35","./element-ui/button.css":"6658","./element-ui/calendar.css":"7d55","./element-ui/card.css":"2b58","./element-ui/carousel-item.css":"c44a","./element-ui/carousel.css":"bdcb","./element-ui/cascader-panel.css":"d570","./element-ui/cascader.css":"77f3","./element-ui/checkbox-button.css":"9340","./element-ui/checkbox-group.css":"c3e4","./element-ui/checkbox.css":"b6da","./element-ui/col.css":"db47","./element-ui/collapse-item.css":"8fde","./element-ui/collapse.css":"07e9","./element-ui/color-picker.css":"435e","./element-ui/container.css":"eb9d","./element-ui/date-picker.css":"aee7","./element-ui/descriptions-item.css":"2c80","./element-ui/descriptions.css":"950b","./element-ui/dialog.css":"77f4","./element-ui/display.css":"282e","./element-ui/divider.css":"60d0","./element-ui/drawer.css":"d107","./element-ui/dropdown-item.css":"b6e7","./element-ui/dropdown-menu.css":"7e48","./element-ui/dropdown.css":"64d8","./element-ui/empty.css":"01aa","./element-ui/fonts/element-icons.ttf":"33df","./element-ui/fonts/element-icons.woff":"089a","./element-ui/footer.css":"3154","./element-ui/form-item.css":"c5fd","./element-ui/form.css":"715c","./element-ui/header.css":"0c82","./element-ui/icon.css":"7d56","./element-ui/image.css":"ef25","./element-ui/index.css":"0d7e","./element-ui/infinite-scroll.css":"8441","./element-ui/infiniteScroll.css":"b932","./element-ui/input-number.css":"91f2","./element-ui/input.css":"6939","./element-ui/link.css":"d7fd","./element-ui/loading.css":"fd06","./element-ui/main.css":"4ba7","./element-ui/menu-item-group.css":"dc0d","./element-ui/menu-item.css":"b9f4","./element-ui/menu.css":"daf0","./element-ui/message-box.css":"6b83","./element-ui/message.css":"cd45","./element-ui/notification.css":"8f76","./element-ui/option-group.css":"0dcb","./element-ui/option.css":"25a0","./element-ui/page-header.css":"3020","./element-ui/pagination.css":"0ca3","./element-ui/popconfirm.css":"a14b","./element-ui/popover.css":"eff5","./element-ui/popper.css":"b95a","./element-ui/progress.css":"20d0","./element-ui/radio-button.css":"3e93","./element-ui/radio-group.css":"2bd1","./element-ui/radio.css":"c87f","./element-ui/rate.css":"63bd","./element-ui/reset.css":"973c","./element-ui/result.css":"4118","./element-ui/row.css":"76ff","./element-ui/scrollbar.css":"b983","./element-ui/select-dropdown.css":"8df7","./element-ui/select.css":"304d","./element-ui/skeleton-item.css":"9362","./element-ui/skeleton.css":"2116","./element-ui/slider.css":"ee53","./element-ui/spinner.css":"824c","./element-ui/step.css":"1ce8","./element-ui/steps.css":"fce6","./element-ui/submenu.css":"2e74","./element-ui/switch.css":"9872","./element-ui/tab-pane.css":"947b","./element-ui/table-column.css":"a21c","./element-ui/table.css":"ed38","./element-ui/tabs.css":"c648","./element-ui/tag.css":"c22a","./element-ui/time-picker.css":"c214","./element-ui/time-select.css":"2318","./element-ui/timeline-item.css":"90d2","./element-ui/timeline.css":"7aad","./element-ui/tooltip.css":"d159","./element-ui/transfer.css":"a452","./element-ui/tree.css":"f29b","./element-ui/upload.css":"68dc","./logined.svg":"15f5","./logo.png":"cf05","./my-style.css":"b8b1","./un-login.svg":"a1af"};function r(e){var t=i(e);return n(t)}function i(e){if(!n.o(s,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return s[e]}r.keys=function(){return Object.keys(s)},r.resolve=i,e.exports=r,r.id="1771"},"1ce8":function(e,t,n){},"1dca":function(e,t,n){e.exports=n.p+"img/an-login.fce77a4b.svg"},"20d0":function(e,t,n){},2116:function(e,t,n){},2318:function(e,t,n){},"25a0":function(e,t,n){},"25e6":function(e,t,n){},"25f7":function(e,t,n){"use strict";n("a3f5")},"282e":function(e,t,n){},"2b58":function(e,t,n){},"2bd1":function(e,t,n){},"2c80":function(e,t,n){},"2e74":function(e,t,n){},3020:function(e,t,n){},"304d":function(e,t,n){},3154:function(e,t,n){},"32fd":function(e,t,n){"use strict";n("4980")},"33df":function(e,t,n){e.exports=n.p+"fonts/element-icons.732389de.ttf"},"3cf0":function(e,t,n){},"3e93":function(e,t,n){},4118:function(e,t,n){},"435e":function(e,t,n){},4980:function(e,t,n){},"4ba7":function(e,t,n){},5467:function(e,t,n){},"56d7":function(e,t,n){"use strict";n.r(t);var s=n("5530"),r=(n("0fae"),n("9e2f")),i=n.n(r),o=(n("e260"),n("e6cf"),n("cca6"),n("a79d"),n("2b0e")),a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("el-row",{attrs:{type:"flex",justify:"space-around"}},[n("el-col",{attrs:{xs:24,sm:20,md:16,lg:12}},[n("keep-alive",{attrs:{exclude:"Document"}},[n("router-view")],1)],1)],1)],1)},c=[],l={name:"App"},u=l,d=(n("034f"),n("2877")),m=Object(d["a"])(u,a,c,!1,null,null,null),f=m.exports,p=n("d148"),g=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"inedx"},[n("div",{staticClass:"flex justify-between items-center"},[e._m(0),n("div",[n("el-button",{attrs:{type:"text",size:"small",icon:"el-icon-user"},on:{click:function(t){return e.$router.push({path:"/cloud"})}}},[e._v("账户")])],1)]),n("div",{staticClass:"search"},[n("div",{staticClass:"search-inp"},[n("el-input",{attrs:{placeholder:"搜索或输入网址",clearable:"","prefix-icon":"el-icon-search"},model:{value:e.url,callback:function(t){e.url=t},expression:"url"}})],1),n("div",{staticClass:"search-btn"},[n("el-dropdown",{attrs:{"split-button":"",type:"primary",trigger:"click"},on:{click:function(t){return e.search(e.url,"google")},command:e.clickMore}},[e._v(" 搜索 "),n("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[n("el-dropdown-item",{attrs:{command:"douban"}},[e._v("搜日记")]),n("el-dropdown-item",{attrs:{command:"v2ex"}},[e._v("搜热议")])],1)],1)],1)]),n("div",{staticClass:"p-4 flex justify-center flex-wrap"},e._l(e.keywords,(function(t){return n("div",{key:t.name,staticClass:"p-2"},[n("el-link",{attrs:{type:"primary"},on:{click:function(n){return e.$router.push({path:"/document",query:{url:"url"===t.openType?t.url:t.name}})}}},[e._v(e._s(t.name))])],1)})),0),e.historys.length?n("el-card",{staticClass:"historys",attrs:{shadow:"never"}},[n("div",{staticClass:"not-importent historys-header",attrs:{slot:"header"},slot:"header"},[n("div",[n("span",[e._v("历史记录")])]),n("div",[n("el-button",{staticClass:"el-icon-delete",attrs:{type:"text"},on:{click:e.clearHistorys}})],1)]),e._l(e.historys,(function(t,s){return n("div",{key:t.time,staticClass:"history"},[s?n("el-divider"):e._e(),n("div",{staticClass:"history-inner"},[n("div",[n("el-link",{on:{click:function(n){return e.openHistoryDocument(t)}}},[e._v(e._s(t.title))])],1)])],1)}))],2):e._e()],1)},h=[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"logo"},[s("img",{attrs:{src:n("cf05"),alt:"logo"}})])}],v=(n("99af"),n("4de4"),n("d81d"),n("fb6a"),n("d3b7"),n("ac1f"),n("841c"),n("96cf"),n("1da1")),b={name:"Index",data:function(){return{url:"",historys:[],keywordsLoading:!1,keywords:[]}},activated:function(){var e=JSON.parse(localStorage.getItem("documentHistory")||"[]");this.historys=e.slice(0,100).map((function(e){return e.star=!!e.star,e}))},created:function(){var e=this;return Object(v["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.keywordsLoading=!0,t.prev=1,t.next=4,fetch("https://service-o4amteg7-1252108641.sh.apigw.tencentcs.com/release/tcb-dba",{method:"POST",body:JSON.stringify({action:"reader-get-keywords",data:{}})}).then((function(e){return e.json()}));case 4:n=t.sent,e.keywords=n.keywords,t.next=11;break;case 8:t.prev=8,t.t0=t["catch"](1),console.log(t.t0);case 11:return t.prev=11,e.keywordsLoading=!1,t.finish(11);case 14:case"end":return t.stop()}}),t,null,[[1,8,11,14]])})))()},computed:{allHistory:function(){return this.staredHistorys.concat(this.historys)}},methods:{search:function(e,t){e&&this.$router.push({path:"/document",query:{url:e,source:t}})},openHistoryDocument:function(e){this.$router.push({path:"/document",query:{url:e.url}})},switchHistoryStar:function(e){e.star=!e.star,e.time=Date.now(),localStorage.setItem("documentHistory",JSON.stringify(this.historys))},clearHistorys:function(){this.historys=this.historys.filter((function(e){return e.star})),localStorage.setItem("documentHistory",JSON.stringify(this.historys))},clickMore:function(e){this.search(this.url,e)}}},w=b,y=(n("32fd"),Object(d["a"])(w,g,h,!1,null,"e24415f8",null)),C=y.exports,x=function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.document?n("div",{staticClass:"document"},[n("el-page-header",{attrs:{content:e.document.title,title:"首页"},on:{back:function(t){return e.$router.push("/")}}}),n("div",{class:e.showShareCard?"opacity-10":0},e._l(e.document.list,(function(t){return n("div",{key:t.insideId,staticClass:"content"},["text"==t.type?n("p",[t.ref?n("el-link",{attrs:{type:"primary"},on:{click:function(n){return e.$router.push({query:{url:t.ref}})}}},[e._v(e._s(t.content))]):n("span",[e._v(e._s(t.content))])],1):"img"==t.type?n("p",[n("el-image",{staticClass:"w-32 h-32",attrs:{src:t.content,"preview-src-list":e.imgSrcList}})],1):"video"==t.type?n("p",[n("video",{attrs:{src:t.content,controls:""}})]):n("p",[n("span",[e._v("[未知类型]"+e._s(t.content))])])])})),0),n("div",{staticClass:"fixed bottom-1 right-1 z-10"},[n("div",{ref:"shareCardDemo",staticClass:"p-4 border-gray-300 w-80 hidden",style:{backgroundColor:e.shareCard.bgColor}},[n("h2",{staticClass:"text-lg text-center text-black font-bold mb-2"},[e._v(e._s(e.document.title))]),e._l(e.shareCard.imgs,(function(t){return n("div",{key:t,staticClass:"mt-4 max-w-80"},[n("el-image",{staticClass:"w-full",attrs:{src:t},on:{click:function(n){return e.useImgInShardCard(t)}}})],1)})),e._l(e.shareCardSelectedItems,(function(t){return n("p",{key:t.insideId,staticClass:"py-1 break-all"},[e._v(" "+e._s(t.content)+" ")])})),n("p",{staticClass:"py-1 break-all"},[e._v("...")]),n("div",{staticClass:"flex items-center mt-2 justify-between"},[n("div",{staticClass:"text-xs"},[e._v("识别二维码浏览全文")]),n("div",[n("img",{ref:"qrcode",staticClass:"block w-16 h-16",attrs:{src:"",alt:""}})])])],2),n("div",{directives:[{name:"show",rawName:"v-show",value:e.showShareCard,expression:"showShareCard"}],ref:"shareCard",staticClass:"p-2"},[n("img",{ref:"shareCardImg",staticClass:"w-80",attrs:{src:"",alt:""}}),n("div",{staticClass:"text-xs text-gray-500 text-center bg-white pt-2 w-80"},[n("div",[e._v(" ps:长按此卡片可保存或分享 ")]),n("div",{staticClass:"ctrl-card mt-2"},[e.shareCardImgs.length?n("div",{staticClass:"w-80 overflow-auto flex gap-2"},e._l(e.shareCardImgs,(function(t){return n("div",{key:t},[n("el-image",{staticClass:"w-16 h-16 cursor-pointer",attrs:{src:t,fit:"cover"},on:{click:function(n){return e.useImgInShardCard(t)}}})],1)})),0):e._e(),n("div",{staticClass:"flex items-center justify-center mt-2 w-80"},[n("div",{staticClass:"mr-2 flex"},[n("el-color-picker",{attrs:{"show-alpha":"",predefine:e.shareCard.predefineColors},model:{value:e.shareCard.bgColor,callback:function(t){e.$set(e.shareCard,"bgColor",t)},expression:"shareCard.bgColor"}})],1),n("el-select",{attrs:{multiple:"","popper-class":"w-80","multiple-limit":3,"popper-append-to-body":!1,placeholder:"请选择"},model:{value:e.shareCard.checkList,callback:function(t){e.$set(e.shareCard,"checkList",t)},expression:"shareCard.checkList"}},e._l(e.shareCardItems,(function(e){return n("el-option",{key:e.insideId,attrs:{label:e.content,value:e.insideId}})})),1)],1)]),n("div",{staticClass:"py-2"},[n("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-download"},on:{click:e.downloadShareCard}},[e._v("保存")]),n("el-button",{attrs:{type:"default",size:"small",icon:"el-icon-close"},on:{click:e.cancleShare}},[e._v("取消")]),n("el-button",{attrs:{type:"default",size:"small",icon:"el-icon-refresh"},on:{click:e.shareByCard}},[e._v("重绘")])],1)])]),n("div",{directives:[{name:"show",rawName:"v-show",value:!e.showShareCard,expression:"!showShareCard"}],staticClass:"p-2"},[n("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-share"},on:{click:e.shareByCard}},[e._v("分享")]),n("el-button",{attrs:{type:"default",size:"small",icon:"el-icon-star-off"},on:{click:e.addUserCollect}},[e._v("收藏")])],1)]),n("div",{staticClass:"not-importent host-tip"},[n("el-link",{attrs:{href:e.document.url,target:"_blank",type:"info"}},[e._v("内容由"+e._s(e.urlHost)+"提供")])],1)],1):e._e()},k=[],_=(n("caad"),n("c975"),n("a434"),n("2532"),n("d055")),S=n.n(_),O=n("c0e9"),$=n.n(O),L={name:"Document",props:{url:{type:String,required:!0},source:{type:String}},data:function(){return{document:null,cachedDocuments:{},showShareCard:!1,shareCard:{bgColor:"rgba(255, 69, 0, 0.68)",checkList:[],imgs:[],predefineColors:["#ff4500","#ff8c00","#ffd700","#90ee90","#00ced1","#1e90ff","#c71585","rgba(255, 69, 0, 0.68)","rgb(255, 120, 0)","hsv(51, 100, 98)","hsva(120, 40, 94, 0.5)","hsl(181, 100%, 37%)","hsla(209, 100%, 56%, 0.73)","#c7158577"]}}},computed:{urlHost:function(){if(!this.document)return"";var e=/^https?:\/\/(.+?)(?:(?:\/)|$)/i.exec(this.document.url);return e[1]||this.document.url},imgSrcList:function(){return this.document?this.document.list.filter((function(e){return"img"==e.type})).map((function(e){return e.content})):[]},shareCardImgs:function(){return this.imgSrcList.slice(0,30)},shareCardItems:function(){return this.document?this.document.list.slice(0,20):[]},shareCardSelectedItems:function(){var e=this;return this.document?this.document.list.filter((function(t){return e.shareCard.checkList.includes(t.insideId)})):[]}},watch:{url:function(e){if(e){var t=this.cachedDocuments[e];t?(this.document=t,this.pushHistory(),scrollTo(0,0)):this.loadDocument()}},document:function(e){e&&(window.document.title=e.title)},"shareCard.bgColor":"shareByCard","shareCard.checkList":{deep:!0,handler:"shareByCard"},"shareCard.imgs":{deep:!0,handler:function(){var e=this,t=this.$loading();setTimeout((function(){t.close(),e.shareByCard()}),1e3)}}},created:function(){this.loadDocument()},methods:{useImgInShardCard:function(e){var t=this.shareCard.imgs.indexOf(e);t>=0?this.shareCard.imgs.splice(t,1):this.shareCard.imgs=[e]},downloadShareCard:function(){var e=document.createElement("a");e.download="share.png",e.href=this.$refs.shareCardImg.src,document.body.appendChild(e),e.click(),e.remove(),this.cancleShare()},cancleShare:function(){this.showShareCard=!1},shareByCard:function(){var e=this;return Object(v["a"])(regeneratorRuntime.mark((function t(){var n,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,S.a.toDataURL(e.document.url,{color:{light:"#ffffff00"}});case 2:return n=t.sent,console.log(n),e.$refs.qrcode.src=n,e.$refs.shareCardDemo.style.display="block",t.next=8,$()(e.$refs.shareCardDemo,{allowTaint:!0,useCORS:!0,imageTimeout:3e4});case 8:s=e.shareCardCanvas=t.sent,e.$refs.shareCardDemo.style.display="none",e.$refs.shareCardImg.src=s.toDataURL("image/png"),e.showShareCard=!0;case 12:case"end":return t.stop()}}),t)})))()},loadDocument:function(){var e=this;return Object(v["a"])(regeneratorRuntime.mark((function t(){var n,s,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=e.$loading(),console.log("加载：".concat(e.url)),t.prev=2,t.next=5,fetch("".concat("https://service-ifv9sp1e-1252108641.sg.apigw.tencentcs.com/release/load-document","?url=").concat(e.url,"&source=").concat(e.source));case 5:return s=t.sent,t.next=8,s.json();case 8:r=t.sent,console.log(r),e.document=e.cachedDocuments[e.url]=r,n.close(),e.pushHistory(),scrollTo(0,0),t.next=19;break;case 16:t.prev=16,t.t0=t["catch"](2),e.$message.error(t.t0.message);case 19:return t.prev=19,n.close(),t.finish(19);case 22:case"end":return t.stop()}}),t,null,[[2,16,19,22]])})))()},pushHistory:function(){var e=JSON.parse(localStorage.getItem("documentHistory")||"[]"),t={title:this.document.title,url:this.document.url,time:Date.now()};e=e.filter((function(e){return e.star||e.url!=t.url})),e.unshift(t),localStorage.setItem("documentHistory",JSON.stringify(e))},addUserCollect:function(){var e=this;return Object(v["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e.cloudAuth.hasLoginState()){t.next=7;break}return t.next=3,fetch("https://service-o4amteg7-1252108641.sh.apigw.tencentcs.com/release/tcb-dba",{method:"POST",body:JSON.stringify({action:"ty-add-reader-user-collect",data:{openid:e.cloudAuth.currentUser.uid,url:e.document.url,title:e.document.title}})}).then((function(e){return e.json()}));case 3:n=t.sent,n.res.code?(console.log(n.res),e.$message.error("操作失败，请稍后重试")):e.$message.success("已收藏"),t.next=8;break;case 7:e.$message.warning("需登录");case 8:case"end":return t.stop()}}),t)})))()}}},R=L,F=(n("0604"),Object(d["a"])(R,x,k,!1,null,"ce240a54",null)),D=F.exports,j=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"hello-world"},[s("el-page-header",{attrs:{content:"账户"},on:{back:function(t){return e.$router.back()}}}),s("div",{staticClass:"user"},[s("div",{staticClass:"user-icon flex justify-center"},[s("img",{attrs:{src:n("1771")("./"+e.userIcon),alt:"头像"}})]),s("div",{staticClass:"user-name"},[e._v(e._s(e.userName))])]),s("div",{staticClass:"actions"},[s("div",{staticClass:"action"},[e.user.logined&&0!=e.user.loginType?e._e():s("el-button",{attrs:{type:"primary"},on:{click:function(t){e.loginForm.email=e.user.email,e.showLoginDialog=!0}}},[e._v(e._s(e.loginText))])],1),s("div",{staticClass:"action"},[e.user.logined&&0==e.user.loginType&&!e.user.email?s("el-button",{attrs:{type:"info"},on:{click:function(t){e.showSetEmailDialog=!0}}},[e._v("绑定邮箱")]):e._e()],1),s("div",{staticClass:"action"},[e.user.logined?e._e():s("el-button",{attrs:{type:"text",loading:e.loginLoading},on:{click:e.loginAsAnonymous}},[e._v("匿名登录")])],1),s("div",{staticClass:"action"},[e.user.logined?e._e():s("el-button",{attrs:{type:"success"},on:{click:function(t){e.showRegisterDialog=!0}}},[e._v("注册")])],1),s("div",{staticClass:"action"},[e.user.logined?s("el-popconfirm",{attrs:{title:"确定退出登录吗？"},on:{confirm:e.logout}},[s("el-button",{attrs:{slot:"reference",type:"danger",loading:e.logoutLoading},slot:"reference"},[e._v("退出")])],1):e._e()],1)]),e.user.logined?s("div",{key:e.userName},[s("UserCollect")],1):e._e(),s("el-dialog",{attrs:{title:"登录",visible:e.showLoginDialog,width:"350px"},on:{"update:visible":function(t){e.showLoginDialog=t}}},[s("el-form",{ref:"loginForm",attrs:{model:e.loginForm,rules:e.loginRules,"label-width":"60px"}},[s("el-form-item",{attrs:{label:"邮箱",prop:"email"}},[s("el-input",{attrs:{placeholder:"邮箱","prefix-icon":"el-icon-user"},model:{value:e.loginForm.email,callback:function(t){e.$set(e.loginForm,"email","string"===typeof t?t.trim():t)},expression:"loginForm.email"}})],1),s("el-form-item",{attrs:{label:"密码",prop:"password"}},[s("el-input",{attrs:{placeholder:"密码","prefix-icon":"el-icon-key","show-password":""},model:{value:e.loginForm.password,callback:function(t){e.$set(e.loginForm,"password","string"===typeof t?t.trim():t)},expression:"loginForm.password"}})],1),s("el-form-item",[s("el-button",{attrs:{type:"primary",loading:e.loginLoading},on:{click:e.login}},[e._v(" 登录 ")]),s("el-button",{attrs:{type:"text"},on:{click:e.forgetPassword}},[e._v("忘记密码")])],1)],1)],1),s("el-dialog",{attrs:{title:"绑定邮箱",visible:e.showSetEmailDialog,width:"350px"},on:{"update:visible":function(t){e.showSetEmailDialog=t}}},[s("el-form",{ref:"setEmailForm",attrs:{model:e.setEmailForm,rules:e.setEmailRules,"label-width":"60px"}},[s("el-form-item",{attrs:{label:"邮箱",prop:"email"}},[s("el-input",{attrs:{placeholder:"邮箱","prefix-icon":"el-icon-user"},model:{value:e.setEmailForm.email,callback:function(t){e.$set(e.setEmailForm,"email","string"===typeof t?t.trim():t)},expression:"setEmailForm.email"}})],1),s("el-form-item",{attrs:{label:"密码",prop:"password"}},[s("el-input",{attrs:{placeholder:"密码","prefix-icon":"el-icon-key","show-password":""},model:{value:e.setEmailForm.password,callback:function(t){e.$set(e.setEmailForm,"password","string"===typeof t?t.trim():t)},expression:"setEmailForm.password"}})],1),s("el-form-item",[s("el-button",{attrs:{type:"primary",loading:e.setEmailLoading},on:{click:e.setEmail}},[e._v(" 确定 ")])],1)],1)],1),s("el-dialog",{attrs:{title:"注册",visible:e.showRegisterDialog,width:"350px"},on:{"update:visible":function(t){e.showRegisterDialog=t}}},[s("el-form",{ref:"registerForm",attrs:{model:e.registerForm,rules:e.registerRules,"label-width":"60px"}},[s("el-form-item",{attrs:{label:"邮箱",prop:"email"}},[s("el-input",{attrs:{placeholder:"邮箱","prefix-icon":"el-icon-user"},model:{value:e.registerForm.email,callback:function(t){e.$set(e.registerForm,"email","string"===typeof t?t.trim():t)},expression:"registerForm.email"}})],1),s("el-form-item",{attrs:{label:"密码",prop:"password"}},[s("el-input",{attrs:{placeholder:"密码","prefix-icon":"el-icon-key","show-password":""},model:{value:e.registerForm.password,callback:function(t){e.$set(e.registerForm,"password","string"===typeof t?t.trim():t)},expression:"registerForm.password"}})],1),s("el-form-item",[s("el-button",{attrs:{type:"success",loading:e.registerLoading},on:{click:e.register}},[e._v(" 确定 ")])],1)],1)],1),s("el-dialog",{attrs:{title:"重置密码",visible:e.showResetPasswordDialog,width:"350px"},on:{"update:visible":function(t){e.showResetPasswordDialog=t}}},[s("el-form",{ref:"resetPasswordForm",attrs:{model:e.resetPasswordForm,rules:e.resetPasswordRules,"label-width":"60px"}},[s("el-form-item",{attrs:{label:"邮箱",prop:" "}},[s("el-input",{attrs:{placeholder:"邮箱","prefix-icon":"el-icon-user"},model:{value:e.resetPasswordForm.email,callback:function(t){e.$set(e.resetPasswordForm,"email","string"===typeof t?t.trim():t)},expression:"resetPasswordForm.email"}})],1),s("el-form-item",[s("el-button",{attrs:{type:"primary",loading:e.resetPasswordLoading},on:{click:e.resetPassword}},[e._v(" 确定 ")])],1)],1)],1)],1)},P=[],E=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"user-collect"},[n("el-card",{staticClass:"collects",attrs:{shadow:"never"}},[n("div",{staticClass:"not-importent collects-header",attrs:{slot:"header"},slot:"header"},[n("div",[n("span",[e._v("我的收藏"),n("i",{directives:[{name:"show",rawName:"v-show",value:e.loading,expression:"loading"}],staticClass:"el-icon-loading"})])])]),e._l(e.collects,(function(t,s){return n("div",{key:t.time,staticClass:"collect"},[s?n("el-divider"):e._e(),n("div",{staticClass:"flex justify-between"},[n("div",{staticClass:"mr-4"},[n("el-link",{on:{click:function(n){return e.$router.push({path:"/document",query:{url:t.url}})}}},[e._v(e._s(t.title))])],1),n("el-popconfirm",{attrs:{title:"确定删除吗？"},on:{confirm:function(n){return e.removeCollect(t)}}},[n("el-button",{staticClass:"collect-delete",attrs:{slot:"reference",type:"text",icon:"el-icon-delete"},slot:"reference"},[e._v(" 删除 ")])],1)],1)],1)}))],2)],1)},I=[],A={data:function(){return{collects:[],loading:!1}},created:function(){var e=this;return Object(v["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.loading=!0,t.prev=1,t.next=4,fetch("https://service-o4amteg7-1252108641.sh.apigw.tencentcs.com/release/tcb-dba",{method:"POST",body:JSON.stringify({action:"ty-query-reader-user-collect",data:{openid:e.cloudAuth.currentUser.uid}})}).then((function(e){return e.json()}));case 4:n=t.sent,e.collects=n,t.next=11;break;case 8:t.prev=8,t.t0=t["catch"](1),console.log(t.t0);case 11:return t.prev=11,e.loading=!1,t.finish(11);case 14:case"end":return t.stop()}}),t,null,[[1,8,11,14]])})))()},methods:{removeCollect:function(e){var t=this;return Object(v["a"])(regeneratorRuntime.mark((function n(){var s;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,fetch("https://service-o4amteg7-1252108641.sh.apigw.tencentcs.com/release/tcb-dba",{method:"POST",body:JSON.stringify({action:"ty-remove-reader-user-collect",data:{openid:t.cloudAuth.currentUser.uid,collectId:e._id}})}).then((function(e){return e.json()}));case 2:s=n.sent,console.log(s),s.code?t.$message.error("操作失败，请稍后重试"):t.collects=t.collects.filter((function(t){return t._id!=e._id}));case 5:case"end":return n.stop()}}),n)})))()}}},T=A,N=Object(d["a"])(T,E,I,!1,null,null,null),U=N.exports,q={name:"EoCloud",props:{msg:String},components:{UserCollect:U},data:function(){return{user:{email:"",logined:!1,loginType:""},showLoginDialog:!1,loginForm:{email:"",password:""},loginRules:{email:[{required:!0,trigger:"blur"}],password:[{required:!0,trigger:"blur"}]},loginLoading:!1,logoutLoading:!1,showSetEmailDialog:!1,setEmailForm:{email:"",password:""},setEmailRules:{email:[{required:!0,trigger:"blur"}],password:[{required:!0,trigger:"blur"}]},setEmailLoading:!1,showRegisterDialog:!1,registerForm:{email:"",password:""},registerRules:{email:[{required:!0,trigger:"blur"}],password:[{required:!0,trigger:"blur"}]},registerLoading:!1,showResetPasswordDialog:!1,resetPasswordForm:{email:""},resetPasswordRules:{email:[{required:!0,trigger:"blur"}]},resetPasswordLoading:!1}},computed:{userIcon:function(){return this.user.logined?"0"==this.user.loginType?"an-login.svg":"logined.svg":"un-login.svg"},userName:function(){return this.user.logined?"0"==this.user.loginType?"匿名用户":this.user.email:"未登录"},loginText:function(){return(this.user.email?"使用"+this.user.email:"邮箱")+"登录"}},created:function(){var e=this;this.cloudAuth.onLoginStateChanged((function(t){console.log(t,e.cloudAuth.currentUser),e.cloudAuth.getLoginState().then(console.log),t?(e.user.logined=!0,e.user.loginType="ANONYMOUS"==t.loginType?"0":"1",e.user.email=t.user.email):e.user.logined=!1}))},methods:{login:function(){var e=this;return Object(v["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.loginLoading=!0,t.prev=1,t.next=4,e.$refs.loginForm.validate();case 4:return t.next=6,e.cloudAuth.signInWithEmailAndPassword(e.loginForm.email,e.loginForm.password);case 6:e.showLoginDialog=!1,e.$notify({message:"登录成功",type:"success"}),t.next=13;break;case 10:t.prev=10,t.t0=t["catch"](1),e.$notify({message:t.t0.message||"请检查表单",type:"error"});case 13:return t.prev=13,e.loginLoading=!1,t.finish(13);case 16:case"end":return t.stop()}}),t,null,[[1,10,13,16]])})))()},logout:function(){var e=this;return Object(v["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.logoutLoading=!0;try{e.cloudAuth.signOut()}catch(n){e.$notify({message:n.message,type:"error"})}finally{e.logoutLoading=!1}case 2:case"end":return t.stop()}}),t)})))()},loginAsAnonymous:function(){var e=this;return Object(v["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.loginLoading=!0,t.prev=1,t.next=4,e.cloudAuth.anonymousAuthProvider().signIn();case 4:n=t.sent,console.log(n),e.showLoginDialog=!1,t.next=12;break;case 9:t.prev=9,t.t0=t["catch"](1),e.$notify({message:t.t0.message,type:"error"});case 12:return t.prev=12,e.loginLoading=!1,t.finish(12);case 15:case"end":return t.stop()}}),t,null,[[1,9,12,15]])})))()},setEmail:function(){var e=this;return Object(v["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.setEmailLoading=!0,t.prev=1,t.next=4,e.cloudAuth.currentUser.updateUsername(e.cloudAuth.currentUser.uid);case 4:return t.next=6,e.cloudAuth.currentUser.updatePassword(e.setEmailForm.password);case 6:return t.next=8,e.cloudAuth.currentUser.updateEmail(e.setEmailForm.email);case 8:e.showSetEmailDialog=!1,e.$notify({message:"验证邮件已发送，请检查邮箱以激活",type:"success"}),t.next=15;break;case 12:t.prev=12,t.t0=t["catch"](1),e.$notify({message:t.t0.message,type:"error"});case 15:return t.prev=15,e.setEmailLoading=!1,t.finish(15);case 18:case"end":return t.stop()}}),t,null,[[1,12,15,18]])})))()},register:function(){var e=this;return Object(v["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.registerLoading=!0,t.prev=1,t.next=4,e.cloudAuth.signUpWithEmailAndPassword(e.registerForm.email,e.registerForm.password);case 4:e.showRegisterDialog=!1,e.$notify({message:"验证邮件已发送，请检查邮箱以激活",type:"success"}),t.next=11;break;case 8:t.prev=8,t.t0=t["catch"](1),e.$notify({message:t.t0.message,type:"error"});case 11:return t.prev=11,e.registerLoading=!1,t.finish(11);case 14:case"end":return t.stop()}}),t,null,[[1,8,11,14]])})))()},forgetPassword:function(){this.resetPasswordForm.email=this.loginForm.email,this.showResetPasswordDialog=!0},resetPassword:function(){var e=this;return Object(v["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.resetPasswordLoading=!0,t.prev=1,t.next=4,e.cloudAuth.sendPasswordResetEmail(e.resetPasswordForm.email);case 4:e.showResetPasswordDialog=!1,e.$notify({message:"验证邮件已发送，请检查邮箱以激活",type:"success"}),t.next=11;break;case 8:t.prev=8,t.t0=t["catch"](1),e.$notify({message:t.t0.message,type:"error"});case 11:return t.prev=11,e.resetPasswordLoading=!1,t.finish(11);case 14:case"end":return t.stop()}}),t,null,[[1,8,11,14]])})))()}}},H=q,J=(n("25f7"),Object(d["a"])(H,j,P,!1,null,"5c058fd2",null)),M=J.exports,z=n("8c4f"),B=(n("b972"),n("0d7e"),n("b8b1"),o["default"].prototype.cloud=p["a"].init({env:"dev-9g0suwuw61afb9f3"}));o["default"].prototype.cloudAuth=B.auth({persistence:"local"}),o["default"].use(z["a"]),o["default"].use(i.a),o["default"].config.productionTip=!1;var W=[{path:"/",component:C},{path:"/index",component:C},{path:"/document",component:D,props:function(e){return Object(s["a"])({},e.query)}},{path:"/cloud",component:M,props:!0}],Y=new z["a"]({routes:W});new o["default"]({render:function(e){return e(f)},router:Y}).$mount("#app")},"5e35":function(e,t,n){},"60c7":function(e,t,n){},"60d0":function(e,t,n){},"62a1":function(e,t,n){},"63bd":function(e,t,n){},"64d8":function(e,t,n){},6658:function(e,t,n){},"68dc":function(e,t,n){},6939:function(e,t,n){},"6b83":function(e,t,n){},"6dcb":function(e,t,n){},"715c":function(e,t,n){},"76ff":function(e,t,n){},"77f3":function(e,t,n){},"77f4":function(e,t,n){},"7aad":function(e,t,n){},"7d55":function(e,t,n){},"7d56":function(e,t,n){},"7e48":function(e,t,n){},8068:function(e,t,n){},"824c":function(e,t,n){},"832e":function(e,t,n){},8441:function(e,t,n){},"85ec":function(e,t,n){},"8df7":function(e,t,n){},"8f76":function(e,t,n){},"8fde":function(e,t,n){},"90d2":function(e,t,n){},"91f2":function(e,t,n){},9340:function(e,t,n){},9362:function(e,t,n){},"947b":function(e,t,n){},"950b":function(e,t,n){},"973c":function(e,t,n){},9872:function(e,t,n){},a14b:function(e,t,n){},a1af:function(e,t,n){e.exports=n.p+"img/un-login.fe221741.svg"},a21c:function(e,t,n){},a3f5:function(e,t,n){},a452:function(e,t,n){},aad5:function(e,t,n){},aee7:function(e,t,n){},b6da:function(e,t,n){},b6e7:function(e,t,n){},b8b1:function(e,t,n){},b932:function(e,t,n){},b95a:function(e,t,n){},b983:function(e,t,n){},b9f4:function(e,t,n){},bdcb:function(e,t,n){},c214:function(e,t,n){},c22a:function(e,t,n){},c3e4:function(e,t,n){},c44a:function(e,t,n){},c5fd:function(e,t,n){},c648:function(e,t,n){},c87f:function(e,t,n){},cd45:function(e,t,n){},cf05:function(e,t,n){e.exports=n.p+"img/logo.863ee97c.png"},d107:function(e,t,n){},d159:function(e,t,n){},d570:function(e,t,n){},d7fd:function(e,t,n){},daf0:function(e,t,n){},db47:function(e,t,n){},dc0d:function(e,t,n){},eb9d:function(e,t,n){},ed38:function(e,t,n){},ee53:function(e,t,n){},ef25:function(e,t,n){},eff5:function(e,t,n){},f29b:function(e,t,n){},fce6:function(e,t,n){},fd06:function(e,t,n){}});
//# sourceMappingURL=app.d03ba5ae.js.map