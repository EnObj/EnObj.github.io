(function(t){function e(e){for(var r,c,i=e[0],s=e[1],l=e[2],d=0,p=[];d<i.length;d++)c=i[d],Object.prototype.hasOwnProperty.call(o,c)&&o[c]&&p.push(o[c][0]),o[c]=0;for(r in s)Object.prototype.hasOwnProperty.call(s,r)&&(t[r]=s[r]);a&&a(e);while(p.length)p.shift()();return u.push.apply(u,l||[]),n()}function n(){for(var t,e=0;e<u.length;e++){for(var n=u[e],r=!0,i=1;i<n.length;i++){var s=n[i];0!==o[s]&&(r=!1)}r&&(u.splice(e--,1),t=c(c.s=n[0]))}return t}var r={},o={app:0},u=[];function c(e){if(r[e])return r[e].exports;var n=r[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,c),n.l=!0,n.exports}c.m=t,c.c=r,c.d=function(t,e,n){c.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},c.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},c.t=function(t,e){if(1&e&&(t=c(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(c.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)c.d(n,r,function(e){return t[e]}.bind(null,r));return n},c.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return c.d(e,"a",e),e},c.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},c.p="";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],s=i.push.bind(i);i.push=e,i=i.slice();for(var l=0;l<i.length;l++)e(i[l]);var a=s;u.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"4fc5":function(t,e,n){"use strict";n("78f0")},"56d7":function(t,e,n){"use strict";n.r(e);n("d3b7"),n("e260"),n("e6cf"),n("cca6"),n("a79d");var r=n("2b0e"),o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"app"}},[n("keep-alive",{attrs:{exclude:"Document"}},[n("router-view")],1)],1)},u=[],c={name:"App"},i=c,s=n("2877"),l=Object(s["a"])(i,o,u,!1,null,null,null),a=l.exports,d=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"inedx"},[n("h1",[t._v("场宁阅读器")]),n("div",{staticClass:"search"},[n("el-input",{attrs:{placeholder:"搜索或输入网址",clearable:"","prefix-icon":"el-icon-search"},on:{change:function(e){return t.search(t.url)}},model:{value:t.url,callback:function(e){t.url=e},expression:"url"}})],1),t.historys.length?n("el-card",{staticClass:"historys",attrs:{shadow:"never"}},[n("div",{staticClass:"not-importent",attrs:{slot:"header"},slot:"header"},[n("span",[t._v("历史记录")])]),t._l(t.historys,(function(e,r){return n("div",{key:e.time,staticClass:"history"},[r?n("el-divider"):t._e(),n("el-link",{on:{click:function(e){return t.openHistoryDocument(r)}}},[t._v(t._s(e.title))])],1)}))],2):t._e()],1)},p=[],f=(n("fb6a"),n("a434"),{name:"Index",data:function(){return{url:"",historys:[]}},activated:function(){var t=JSON.parse(localStorage.getItem("documentHistory")||"[]");this.historys=t.slice(0,100)},methods:{search:function(t){t&&this.$router.push({path:"/document",query:{url:t}})},openHistoryDocument:function(t){var e=this.historys[t];this.historys.splice(t,1),localStorage.setItem("documentHistory",JSON.stringify(this.historys)),this.$router.push({path:"/document",query:{url:e.url}})}}}),h=f,m=(n("9446"),Object(s["a"])(h,d,p,!1,null,"d5575982",null)),v=m.exports,y=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.document?n("div",{staticClass:"document"},[n("el-page-header",{attrs:{content:"正在阅读"},on:{back:function(e){return t.$router.back()}}}),n("h1",[t._v(t._s(t.document.title))]),n("div",{staticClass:"contents"},t._l(t.document.list,(function(e){return n("div",{key:e.insideId,staticClass:"content"},["text"==e.type?n("p",[e.ref?n("el-link",{attrs:{type:"primary"},on:{click:function(n){return t.$router.push({query:{url:e.ref}})}}},[t._v(t._s(e.content))]):n("span",[t._v(t._s(e.content))])],1):"img"==e.type?n("p",[n("el-image",{attrs:{src:e.content}})],1):t._e()])})),0),n("div",{staticClass:"not-importent host-tip"},[n("el-link",{attrs:{href:t.document.url,target:"_blank",type:"info"}},[t._v("内容由"+t._s(t.urlHost)+"提供")])],1)],1):t._e()},b=[],g=(n("ac1f"),{name:"Document",props:{url:{type:String,required:!0}},data:function(){return{document:null,cachedDocuments:{}}},computed:{urlHost:function(){if(!this.document)return"";var t=/^https?:\/\/(.+?)(?:(?:\/)|$)/i.exec(this.document.url);return t[1]||this.document.url}},watch:{url:function(t){if(t){var e=this.cachedDocuments[t];e?(this.document=e,this.pushHistory(),scrollTo(0,0)):this.loadDocument()}}},created:function(){this.loadDocument()},methods:{loadDocument:function(){var t=this,e=this.$loading();console.log("加载：".concat(this.url)),this.cloud.callFunction({name:"loadDocument",data:{url:this.url}}).then((function(n){t.document=t.cachedDocuments[t.url]=n.result,e.close(),t.pushHistory(),scrollTo(0,0)})).catch((function(t){console.error(t),e.close()}))},pushHistory:function(){var t=JSON.parse(localStorage.getItem("documentHistory")||"[]");t.unshift({title:this.document.title,url:this.document.url,time:Date.now()}),localStorage.setItem("documentHistory",JSON.stringify(t))}}}),_=g,x=(n("4fc5"),Object(s["a"])(_,y,b,!1,null,"b0c6ac0c",null)),O=x.exports,w=n("8c4f"),j=n("d148"),k=n("5c96"),S=n.n(k);n("0fae"),n("b8b1");r["default"].use(w["a"]),r["default"].use(S.a),r["default"].config.productionTip=!1;var D=[{path:"/",component:v},{path:"/index",component:v},{path:"/document",component:O,props:function(t){return{url:t.query.url}}}],H=new w["a"]({routes:D});function P(){var t=r["default"].prototype.cloud=j["a"].init({env:"xmrl-prod-jawjt"}),e=r["default"].prototype.cloudAuth=t.auth({persistence:"local"});return e.hasLoginState()?(console.log("无需重复登录"),Promise.resolve()):e.anonymousAuthProvider().signIn().then((function(t){return console.log("登录成功",t),Promise.resolve()})).catch((function(t){return console.error("登录失败",t),Promise.reject()}))}P().then((function(){new r["default"]({render:function(t){return t(a)},router:H}).$mount("#app")}))},"78f0":function(t,e,n){},9446:function(t,e,n){"use strict";n("b981")},b8b1:function(t,e,n){},b981:function(t,e,n){}});
//# sourceMappingURL=app.21803bc7.js.map